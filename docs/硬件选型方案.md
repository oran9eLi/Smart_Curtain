# 第3章 硬件选型与设计

---

## 3.1 系统总体架构

智能窗帘控制系统以 **STM32F103C8T6** 微控制器为核心，采用模块化设计思想，将系统划分为**控制核心**、**传感器模块**、**驱动模块**、**通信模块**和**显示模块**五个部分。

| 主控模块 | 传感器模块 | 驱动模块 | 通信模块 | 显示模块 | 输入模块 |
|:--------:|:----------:|:--------:|:--------:|:--------:|:--------:|
| STM32F103C8T6 | 光照传感器 | 步进电机 | 蓝牙串口 | OLED显示 | 薄膜按键 |
| | CO传感器 | | 语音模块 | | |
| | 温湿度传感器 | | | | |


---

## 3.2 主控芯片选型

### 3.2.1 选型依据

本系统选用 ST 公司的 **STM32F103C8T6** 作为主控芯片，该芯片属于 STM32F1 系列中的增强型产品。

|  参数  |        规格        |
|:------:|:-----------------:|
|  内核  |   ARM Cortex-M3   |
|  主频  |      72MHz        |
| Flash  |       64KB        |
|  SRAM  |       20KB        |
| 工作电压 |  2.0V ~ 3.6V    |
|  封装  |      LQFP48       |
| GPIO数量 |     37个        |

### 3.2.2 选型理由

- **丰富的外设资源**  
  本系统需要用到 ADC、DMA、I2C、UART、TIM、IWDG 等多种外设，STM32F103C8T6 内置了所有所需外设，无需外扩芯片。

- **充足的 IO 端口**  
  系统需要控制约 20 个 GPIO，STM32F103C8T6 提供 37 个 GPIO，完全满足需求。

- **低功耗设计**  
  支持多种低功耗模式，适合需要长期运行的家庭智能设备。

- **成熟的开发生态**  
  拥有丰富的例程、完善的 HAL 库和广泛的社区支持。

- **性价比高**  
  市场价约 5-8 元人民币，在性能和价格之间取得良好平衡。

---

## 3.3 传感器模块选型

### 3.3.1 光照传感器

> **选型**：光敏电阻 `GL5528`

|  参数  |      规格       |
|:------:|:--------------:|
|  亮阻  |  5-10kΩ (10Lux) |
|  暗阻  |   ≥1MΩ (0Lux)  |
| 响应波长 |     540nm      |
|  功率  |     100mW      |
| 工作温度 | -30℃ ~ +70℃  |

**电路设计**：光敏电阻与 10kΩ 电阻串联分压，输出模拟电压至 ADC 通道 0（PA0）。

---

### 3.3.2 CO 气体传感器

> **选型**：`MQ-7` CO 气体传感器模块

|    参数    |        规格         |
|:---------:|:------------------:|
|  检测气体  |   一氧化碳 (CO)    |
| 检测浓度  |    20-2000ppm      |
| 工作电压  | 5V (内置3.3V稳压)  |
|  预热时间  |       60秒         |
|   特性    | 对酒精、烟雾敏感度低 |

**电路设计**：MQ-7 模块输出模拟电压信号，通过电压跟随器缓冲后接入 ADC 通道 1（PA1）。

---

### 3.3.3 温湿度传感器

> **选型**：`DHT11` 数字温湿度传感器

|   参数   |        规格        |
|:--------:|:-----------------:|
| 工作电压  |     3.3V-5V       |
| 温度范围  |   0-50℃ (±2℃)    |
| 湿度范围  | 20-90%RH (±5%RH) |
| 响应时间  |       6s          |
|   接口   |  单总线数字信号    |

**电路设计**：DHT11 通过单总线与主控通信，占用 GPIO 一个引脚（PA11），采用开漏输出 + 上拉电阻方式。

---

## 3.4 驱动模块选型

### 3.4.1 步进电机驱动

> **选型**：`28BYJ-48` 步进电机 + `ULN2003` 驱动板

|   参数   |        规格         |
|:--------:|:------------------:|
|  电机型号 |     28BYJ-48      |
| 工作电压  |        5V         |
|   相数   |       4相         |
| 步进角度  |   5.625°/64       |
|  减速比  |      1:64         |
|  驱动芯片 | ULN2003 (达林顿管) |

**控制方式**：采用四相八拍控制方式，通过 4 个 GPIO（PB8、PB9、PA12、PA15）输出脉冲序列驱动电机转动。

---

## 3.5 通信模块选型

### 3.5.1 蓝牙串口模块

> **选型**：`BT04-A` 蓝牙串口模块

|   参数   |       规格        |
|:--------:|:----------------:|
| 工作电压  |      3.3V        |
| 通信接口  | UART (9600bps)  |
| 通信距离  |      10米        |
| 配对方式 |     从机模式      |
|   特性   | 支持SPP蓝牙串口协议 |

**电路设计**：蓝牙模块通过 USART2（PA2=TX, PA3=RX）与主控通信，采用 DMA 方式接收数据。

---

### 3.5.2 语音播报模块

> **选型**：`JR6001` 语音模块

|   参数   |         规格         |
|:--------:|:-------------------:|
| 工作电压  |      3.3V-5V        |
| 存储容量  | 4Mbit (约120秒语音) |
| 通信接口  |    UART (9600bps)   |
|   输出   |  3W功放驱动扬声器   |
|   特性   |  支持MP3格式        |

**电路设计**：语音模块通过 USART3（PB10=TX, PB11=RX）与主控通信。

---

## 3.6 显示模块选型

### 3.6.1 OLED 显示屏

> **选型**：0.96 寸 OLED 显示屏（`SSD1306` 驱动）

|   参数   |     规格     |
|:--------:|:-----------:|
| 屏幕尺寸 |  0.96英寸   |
| 分辨率  |   128×64   |
| 显示颜色 | 白色/蓝色   |
| 驱动芯片 |   SSD1306   |
| 通信接口 |     I2C     |
| I2C地址  |    0x78     |

**电路设计**：OLED 通过 I2C1（PB6=SCL, PB7=SDA）与主控通信。

---

## 3.7 人机交互模块

### 3.7.1 按键输入

> **选型**：4 个薄膜按键

|   按键   |      功能       |
|:--------:|:--------------:|
| KEY1 (PB12) |   模式切换     |
| KEY2 (PB13) |   打开窗帘     |
| KEY3 (PB14) |   关闭窗帘     |
| KEY4 (PB15) |   确认/设置    |

**电路设计**：按键采用上拉输入模式，按键按下时 GPIO 为低电平。

---

### 3.7.2 状态指示

> **选型**：红色 LED + 蜂鸣器

|   器件   | GPIO  |     功能     |
|:--------:|:-----:|:-----------:|
|   LED    |  PB0  |  系统运行指示 |
|  蜂鸣器  |  PC13 |   报警提示音  |

---

## 3.8 看门狗电路

> **选型**：STM32 内置独立看门狗 (`IWDG`)

|   参数   |   规格   |
|:--------:|:-------:|
|  时钟源  | 内部40kHz |
|  预分频  |   256    |
|  重载值  |   625    |
| 超时时间 |  约4秒   |

> **作用**：防止程序死锁或跑飞，提高系统可靠性。

---

## 3.9 本章小结

本章详细阐述了智能窗帘控制系统的硬件选型方案，包括：

| 模块 | 核心器件 |
|:----:|:--------:|
| 主控芯片 | STM32F103C8T6 |
| 光照传感器 | GL5528 |
| CO传感器 | MQ-7 |
| 温湿度传感器 | DHT11 |
| 步进电机 | 28BYJ-48 |
| 蓝牙模块 | BT04-A |
| 语音模块 | JR6001 |
| OLED显示屏 | SSD1306 |

各模块协同工作，实现了**光照检测**、**气体监测**、**无线控制**、**语音提醒**和**状态显示**等完整功能。

---

> **最后更新**：2026年2月  
> **版本**：v1.0
